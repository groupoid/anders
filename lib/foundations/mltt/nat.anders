{- Natural Numbers: https://anders.groupoid.space/foundations/mltt/nat/
   - Nat.

   HoTT 2.13 Natural Numbers
   HoTT 5.3 W-Types
   HoTT 5.5 Homotopy-inductive types

   Copyright (c) Groupoid Infinity, 2014-2023. -}

module nat where
import lib/foundations/mltt/inductive
import lib/foundations/univalent/path

def â„•-ctor := indâ‚‚ (Î» (f : ğŸ), U) ğŸ ğŸ
def â„• := W (x : ğŸ), â„•-ctor x
def zero : â„• := sup ğŸ â„•-ctor 0â‚‚ (indâ‚€ â„•)
def succ (n : â„•) : â„• := sup ğŸ â„•-ctor 1â‚‚ (Î» (x : ğŸ), n)

def ğŸâŸ¶â„• (C : â„• â†’ U) (f : ğŸ â†’ â„•) : C zero â†’ C (sup ğŸ â„•-ctor 0â‚‚ f)
 := transp (<i> C (sup ğŸ â„•-ctor 0â‚‚ (Î» (x : ğŸ), indâ‚€ (PathP (<_> â„•) (indâ‚€ â„• x) (f x)) x @ i))) 0

def ğŸâŸ¶â„• (C : â„• â†’ U) (f : ğŸ â†’ â„•) : C (succ (f â˜…)) â†’ C (sup ğŸ â„•-ctor 1â‚‚ f)
 := transp (<i> C (sup ğŸ â„•-ctor 1â‚‚ (Î» (x : ğŸ), indâ‚ (Î» (y : ğŸ), PathP (<_> â„•) (f â˜…) (f y)) (<_> f â˜…) x @ i))) 0

def â„•-ind (C : â„• â†’ U) (z : C zero) (s : Î  (n : â„•), C n â†’ C (succ n)) : Î  (n : â„•), C n
 := indáµ‚ ğŸ â„•-ctor C
    (indâ‚‚ (Î» (x : ğŸ), Î  (f : â„•-ctor x â†’ â„•), (Î  (b : â„•-ctor x), C (f b)) â†’ C (sup ğŸ â„•-ctor x f))
          (Î» (f : ğŸ â†’ â„•) (g : Î  (x : ğŸ), C (f x)), ğŸâŸ¶â„• C f z)
          (Î» (f : ğŸ â†’ â„•) (g : Î  (x : ğŸ), C (f x)), ğŸâŸ¶â„• C f (s (f â˜…) (g â˜…))))

def â„•-rec (C : U) (z : C) (s : â„• â†’ C â†’ C) : â„• â†’ C := â„•-ind (Î» (_ : â„•), C) z s
def â„•-iter (C : U) (z : C) (s : C â†’ C) : â„• â†’ C := â„•-rec C z (Î» (_ : â„•), s)
def â„•-case (C : U) (z s : C) : â„• â†’ C := â„•-iter C z (Î» (_ : C), s)
def plus : â„• â†’ â„• â†’ â„• := â„•-iter (â„• â†’ â„•) (idfun â„•) (âˆ˜ â„• â„• â„• succ)
def mult : â„• â†’ â„• â†’ â„• := â„•-rec (â„• â†’ â„•) (\(_: â„•), zero) (\(_: â„•) (x: â„• â†’ â„•) (m: â„•), plus m (x m))
def one : â„• := succ zero
def two : â„• := succ one
def three : â„• := succ two
def four : â„• := succ three
def five : â„• := succ four
def six : â„• := succ five
def seven : â„• := succ six
def eight : â„• := succ seven
def nine : â„• := succ eight
def ten : â„• := succ nine

def 5â€² : â„• := plus two three
def 10â€² : â„• := mult 5â€² two
def 55â€² : â„• := plus (mult 5â€² 10â€²) 5â€²

