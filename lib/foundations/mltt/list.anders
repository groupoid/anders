{- Run-Time List Type: https://anders.groupoid.space/foundations/mltt/list/
   - List;

   HoTT 5.3 W-Types

   Copyright (c) Groupoid Infinity, 2014-2022. -}

module list where
import lib/foundations/mltt/maybe
import lib/foundations/mltt/nat
option girard true

-- def L-ctor (A : U)  : U := W (x : Maybe A), maybe-rec A U ğŸ (Î» (a : A), ğŸ) x
-- def N-ctor              := W (x : ğŸ),       indâ‚‚ (Î» (f : ğŸ), U) ğŸ ğŸ x
-- def B-ctor          : U := W (x : + â„• â„•), +-rec â„• â„• (Î» (f : + â„• â„•), U) ğŸ (ğŸ Ã— ğŸ) x
-- def M-ctor (A: U)   : U := Î£ (x : ğŸ),       indâ‚‚ (Î» (f : ğŸ), U) ğŸ A x
-- def +-ctor (A B: U) : U := Î£ (x : ğŸ),       indâ‚‚ (Î» (f : ğŸ), U) A B x

def List-ctor (A: U)
  : Î  (w : Maybe A), U
 := Î» (w : Maybe A), indâ‚‚ (Î» (x: ğŸ),
               Î  (u: indâ‚‚ (Î» (x: ğŸ), U) ğŸ A x), U)
                    (indâ‚ (Î» (x: ğŸ), U) ğŸ)
                          (Î» (a: A), ğŸ) w.1 w.2

def List' (A: U) := maybe-rec A U ğŸ (Î» (a : A), ğŸ)
def List (A: U) := W (x : Maybe A), List-ctor A x
def nil (A: U) : List A := sup (Maybe A) (List-ctor A) (nothing A) (indâ‚€ (List A))
def cons (A: U) (x : A) (xs: List A) : List A := sup (Maybe A) (List-ctor A) (just A x) (Î» (x : ğŸ), xs)

def nil-List (A: U) (C : List A â†’ U) (f : ğŸ â†’ List A) : C (nil A) â†’ C (sup (Maybe A) (List-ctor A) (0â‚‚,â˜…) f)
 := transp (<i> C (sup (Maybe A) (List-ctor A) (0â‚‚,â˜…) (Î» (x : ğŸ), indâ‚€ (PathP (<_> List A) (indâ‚€ (List A) x) (f x)) x @ i))) 0

def cons-List (A: U) (C : List A â†’ U) (f : ğŸ â†’ List A) (x: A) : C (cons A x (f â˜…)) â†’ C (sup (Maybe A) (List-ctor A) (1â‚‚,x) f)
 := transp (<i> C (sup (Maybe A) (List-ctor A) (1â‚‚,x) (Î» (x : ğŸ), indâ‚ (Î» (y : ğŸ), PathP (<_> List A) (f â˜…) (f y)) (<_> f â˜…) x @ i))) 0

def List-ind (A: U) (C: List A -> U)
                    (z: C (nil A))
                    (s: Î  (x: A) (xs: List A), C xs -> C (cons A x xs)) : Î  (n: List A), C n
 := indáµ‚ (Maybe A) (List-ctor A) C (maybe-ind A
         (Î» (x: Maybe A), Î  (f : List-ctor A x â†’ List A), (Î  (b : List-ctor A x), C (f b)) â†’ C (sup (Maybe A) (List-ctor A) x f))
         (Î» (f : ğŸ â†’ List A) (g : Î  (x : ğŸ), C (f x)), nil-List A C f z)
         (Î» (x: A) (f : ğŸ â†’ List A) (g : Î  (x : ğŸ), C (f x)), cons-List A C f x (s x (f â˜…) (g â˜…))))
  
def List-rec  (A: U) (C : U) (z : C) (s : A â†’ List A â†’ C â†’ C) : List A â†’ C := List-ind  A     (Î» (_: List A), C) z s
def List-iter (A: U) (C : U) (z : C) (s : A â†’ C â†’ C)          : List A â†’ C := List-rec  A C z (Î» (x: A) (_: List A), s x)
def List-case (A: U) (C : U) (z : C) (s : A â†’ C)              : List A â†’ C := List-iter A C z (Î» (x: A) (_: C), s x)

def head (A: U): List A â†’ Maybe A
 := List-case A (Maybe A) (nothing A) (Î»(x: A), just A x)

def tail (A: U): List A â†’ Maybe (List A)
 := List-ind A (Î» (_: List A), Maybe (List A))
               (nothing (List A))
               (Î» (a: A) (x: List A) (_: Maybe (List A)), just (List A) x)

def z0 : List ğŸ := nil ğŸ
def z1 : List ğŸ := cons ğŸ â˜… z0
def z2 : List ğŸ := cons ğŸ â˜… z1

def append (A: U): List A -> List A -> List A
 := Î» (x: List A), List-rec A (List A) x (Î» (z: A) (_: List A)(zs: List A), cons A z zs)

{-
def z1=z1+z0 : Path (List ğŸ) z1 (append ğŸ z0 z1)
 := List-ind ğŸ (\(C: List ğŸ), Path (List ğŸ) z1 C)
               ?
               ? (append ğŸ z0 z1)

def append-assoc (A: U)
  : Î  (xs ys zs: List A), Path (List A) (append A (append A xs ys) zs) (append A xs (append A ys zs))
 := Î» (xs ys zs: List A),
    List-ind A (\(C: List A), Path (List A) (append A (append A xs ys) zs) C)
               ?
               ?
               (append A xs (append A ys zs))
-}