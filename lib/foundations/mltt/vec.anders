{- Vector Type: https://anders.groupoid.space/foundations/mltt/vec/
   - Vec.

   HoTT 5.7 Generalization of inductive types

   Copyright (c) Groupoid Infinity, 2014-2023. -}

module vec where
import lib/foundations/mltt/nat
import lib/foundations/mltt/sigma
option girard true

def Vec (A : U‚ÇÅ) : ‚Ñï ‚Üí U := ‚Ñï-iter U ùüè (Œª (X : U), A √ó X)
def vzero (A : U) : Vec A zero := ‚òÖ
def vsucc (A : U) (n : ‚Ñï) (head : A) (tail : Vec A n)
  : Vec A (succ n) := (head, tail)
def Vec-ind (A : U)
    (T : Œ† (n : ‚Ñï), Vec A n ‚Üí U)
    (z : T zero (vzero A))
    (s : Œ† (n : ‚Ñï) (x : A) (v : Vec A n),
         T n v ‚Üí T (succ n) (vsucc A n x v))
    (m : ‚Ñï) : Œ† (x : Vec A m), T m x
 := ‚Ñï-ind (Œª (k : ‚Ñï), Œ† (x : Vec A k), T k x)
          (ind‚ÇÅ (T zero) z)
          (Œª (k : ‚Ñï) (f : Œ† (x : Vec A k), T k x)
             (y : Vec A (succ k)), s k y.1 y.2 (f y.2)) m

def Vec-rec (A B : U) (z : B) (s : Œ† (n : ‚Ñï), A ‚Üí Vec A n ‚Üí B ‚Üí B) (m : ‚Ñï)
  : Vec A m ‚Üí B := Vec-ind A (Œª (n : ‚Ñï) (_ : Vec A n), B) z s m

def Vec-map (A B : U) (f : A ‚Üí B) (n : ‚Ñï)
  : Vec A n ‚Üí Vec B n
 := Vec-ind A (Œª (k : ‚Ñï) (_ : Vec A k), Vec B k) ‚òÖ (Œª (k : ‚Ñï)
                 (x : A) (_ : Vec A k), vsucc B k (f x)) n
