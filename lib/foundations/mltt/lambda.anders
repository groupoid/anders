module lambda where

import lib/foundations/mltt/either

def Tag : U := ğŸ“
def VAR      : Tag := 0â‚…
def UNIV     : Tag := 1â‚…
def PI       : Tag := 2â‚…
def LAM      : Tag := 3â‚…
def APP      : Tag := 4â‚…

def Shape : Tag â†’ U
 := indâ‚… (Î» (_: U), ğŸ)  -- VAR has 0 subterms
         (Î» (_: U), ğŸ)  -- UNIV has 0 subterms
         (Î» (_: U), ğŸ)  -- PI has 2 subterms: domain, codomain
         (Î» (_: U), ğŸ)  -- LAM has 2 subterms: type, body
         (Î» (_: U), ğŸ)  -- APP has 2 subterms: function, argument

def term : U := W (t : Tag), Shape t
def Term : U := Î£ (t : term), Label (tag_of t)
def tag_of (t : term) : Tag
 := W-rec Tag Shape Tag (Î» (t : Tag) (f : Shape t â†’ term), t) t

def Label : Tag â†’ U
 := indâ‚… (Î» (_: U), string) -- VAR
         (Î» (_: U), â„•)      -- UNIV
         (Î» (_: U), string) -- PI
         (Î» (_: U), string) -- LAM
         (Î» (_: U), ğŸ)      -- APP
