{- Finite Set Type: https://anders.groupoid.space/foundations/mltt/fin/
   - Vec.

   Copyright (c) Groupoid Infinity, 2014-2023. -}

module fin where
import lib/foundations/mltt/nat
import lib/foundations/mltt/either

def Fin : â„• â†’ U := â„•-iter U ğŸ (+ ğŸ)
def fzero (n : â„•) : Fin (succ n) := (0â‚‚, â˜…)
def fsucc (n : â„•) (m : Fin n) : Fin (succ n) := (1â‚‚, m)
def Fin-ind (T : Î  (n : â„•), Fin n â†’ U)
    (z : Î  (n : â„•), T (succ n) (fzero n))
    (s : Î  (n : â„•) (x : Fin n), T n x â†’ T (succ n) (fsucc n x))
    (m : â„•) (x : Fin m) : T m x
 := â„•-ind (Î» (k : â„•), Î  (x : Fin k), T k x)
          (Î» (x : ğŸ), indâ‚€ (T zero x) x)
          (Î» (k : â„•) (f : Î  (x : Fin k), T k x),
              +-ind ğŸ (Fin k) (T (succ k))
                      (indâ‚ (Î» (w : ğŸ), T (succ k) (0â‚‚, w)) (z k))
                      (Î» (w : Fin k), s k w (f w))) m x

def ğŸ‘ : U := + ğŸ ğŸ
def 0â‚ƒ : ğŸ‘ := inl ğŸ ğŸ â˜…
def 1â‚ƒ : ğŸ‘ := inr ğŸ ğŸ 0â‚‚
def 2â‚ƒ : ğŸ‘ := inr ğŸ ğŸ 1â‚‚
def indâ‚ƒ (C : ğŸ‘ â†’ U) (câ‚€ : C 0â‚ƒ) (câ‚ : C 1â‚ƒ) (câ‚‚ : C 2â‚ƒ) : Î  (x : ğŸ‘), C x
 := +-ind ğŸ ğŸ C (indâ‚ (Î» (x : ğŸ), C (0â‚‚, x)) câ‚€) (indâ‚‚ (Î» (x : ğŸ), C (1â‚‚, x)) câ‚ câ‚‚)

def ğŸ’ : U := + ğŸ ğŸ
def 0â‚„ : ğŸ’ := inl ğŸ ğŸ 0â‚‚
def 1â‚„ : ğŸ’ := inl ğŸ ğŸ 1â‚‚
def 2â‚„ : ğŸ’ := inr ğŸ ğŸ 0â‚‚
def 3â‚„ : ğŸ’ := inr ğŸ ğŸ 1â‚‚
def indâ‚„ (C : ğŸ’ â†’ U) (câ‚€ : C 0â‚„) (câ‚ : C 1â‚„) (câ‚‚ : C 2â‚„) (câ‚ƒ : C 3â‚„) : Î  (x : ğŸ’), C x
 := +-ind ğŸ ğŸ C (indâ‚‚ (Î» (x : ğŸ), C (0â‚‚, x)) câ‚€ câ‚) (indâ‚‚ (Î» (x : ğŸ), C (1â‚‚, x)) câ‚‚ câ‚ƒ)

def ğŸ“ : U := + ğŸ ğŸ‘
def 0â‚… : ğŸ“ := inl ğŸ ğŸ‘ 0â‚‚
def 1â‚… : ğŸ“ := inl ğŸ ğŸ‘ 1â‚‚
def 2â‚… : ğŸ“ := inr ğŸ ğŸ‘ 0â‚ƒ
def 3â‚… : ğŸ“ := inr ğŸ ğŸ‘ 1â‚ƒ
def 4â‚… : ğŸ“ := inr ğŸ ğŸ‘ 2â‚ƒ
def indâ‚… (C : ğŸ“ â†’ U) (câ‚€ : C 0â‚…) (câ‚ : C 1â‚…) (câ‚‚ : C 2â‚…) (câ‚ƒ : C 3â‚…) (câ‚„ : C 4â‚…) : Î  (x : ğŸ“), C x
 := +-ind ğŸ ğŸ‘ C (indâ‚‚ (Î» (x : ğŸ), C (0â‚‚, x)) câ‚€ câ‚) (indâ‚ƒ (Î» (x : ğŸ‘), C (1â‚‚, x)) câ‚‚ câ‚ƒ câ‚„)

def ğŸ” : U := + ğŸ‘ ğŸ‘
def 0â‚† : ğŸ” := inl ğŸ‘ ğŸ‘ 0â‚ƒ
def 1â‚† : ğŸ” := inl ğŸ‘ ğŸ‘ 1â‚ƒ
def 2â‚† : ğŸ” := inl ğŸ‘ ğŸ‘ 2â‚ƒ
def 3â‚† : ğŸ” := inr ğŸ‘ ğŸ‘ 0â‚ƒ
def 4â‚† : ğŸ” := inr ğŸ‘ ğŸ‘ 1â‚ƒ
def 5â‚† : ğŸ” := inr ğŸ‘ ğŸ‘ 2â‚ƒ
def indâ‚† (C : ğŸ” â†’ U) (câ‚€ : C 0â‚†) (câ‚ : C 1â‚†) (câ‚‚ : C 2â‚†) (câ‚ƒ : C 3â‚†) (câ‚„ : C 4â‚†) (câ‚… : C 5â‚†) : Î  (x : ğŸ”), C x
 := +-ind ğŸ‘ ğŸ‘ C (indâ‚ƒ (Î» (x : ğŸ‘), C (0â‚‚, x)) câ‚€ câ‚ câ‚‚) (indâ‚ƒ (Î» (x : ğŸ‘), C (1â‚‚, x)) câ‚ƒ câ‚„ câ‚…)

def ğŸ• : U := + ğŸ‘ ğŸ’
def 0â‚‡ : ğŸ• := inl ğŸ‘ ğŸ’ 0â‚ƒ
def 1â‚‡ : ğŸ• := inl ğŸ‘ ğŸ’ 1â‚ƒ
def 2â‚‡ : ğŸ• := inl ğŸ‘ ğŸ’ 2â‚ƒ
def 3â‚‡ : ğŸ• := inr ğŸ‘ ğŸ’ 0â‚„
def 4â‚‡ : ğŸ• := inr ğŸ‘ ğŸ’ 1â‚„
def 5â‚‡ : ğŸ• := inr ğŸ‘ ğŸ’ 2â‚„
def 6â‚‡ : ğŸ• := inr ğŸ‘ ğŸ’ 3â‚„
def indâ‚‡ (C : ğŸ• â†’ U) (câ‚€ : C 0â‚‡) (câ‚ : C 1â‚‡) (câ‚‚ : C 2â‚‡) (câ‚ƒ : C 3â‚‡) (câ‚„ : C 4â‚‡) (câ‚… : C 5â‚‡) (câ‚† : C 6â‚‡) : Î  (x : ğŸ•), C x
 := +-ind ğŸ‘ ğŸ’ C (indâ‚ƒ (Î» (x : ğŸ‘), C (0â‚‚, x)) câ‚€ câ‚ câ‚‚) (indâ‚„ (Î» (x : ğŸ’), C (1â‚‚, x)) câ‚ƒ câ‚„ câ‚… câ‚†)
