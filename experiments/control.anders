module control where

-- compilation scheme

-- record pure (P: U â†’ U) (A: U) := (return: P A)
-- record functor (F: U â†’ U) (A B: U) := (fmap: (A â†’ B) â†’ F A â†’ F B)
-- record applicative (F: U â†’ U) (A B: U) extends pure F A, functor F A B := (ap: F (A â†’ B) â†’ F A â†’ F B)
-- record monad (F: U â†’ U) (A B: U) extends pure F A, functor F A B := (join: F (F A) â†’ F B)

def return_sig (F: U â†’ U): Uâ‚ := Î  (A: U), A â†’ F A
def ap_sig     (F: U â†’ U): Uâ‚ := Î  (A B: U), F (A â†’ B) â†’ F A â†’ F B
def fmap_sig   (F: U â†’ U): Uâ‚ := Î  (A B: U), (A â†’ B) â†’ F A â†’ F B
def join_sig   (F: U â†’ U): Uâ‚ := Î  (A: U), F (F A) â†’ F A

def pure:        Uâ‚ := Î£ (F: U â†’ U) (return: return_sig F), ğŸ
def functor:     Uâ‚ := Î£ (F: U â†’ U) (fmap: fmap_sig F), ğŸ
def applicative: Uâ‚ := Î£ (F: U â†’ U) (return: return_sig F)
                                    (fmap: fmap_sig F)
                                    (ap: ap_sig F), ğŸ
def monad:       Uâ‚ := Î£ (F: U â†’ U) (return: return_sig F)
                                    (fmap: fmap_sig F)
                                    (join: join_sig F), ğŸ

def join (m: monad) := m.join

