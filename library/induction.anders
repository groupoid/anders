module induction where

-- Steve Awodey, Nicola Gambino, Kristina Sojakova
-- Inductive Types in Homotopy Type Theory
-- https://arxiv.org/pdf/1201.3898.pdf

def indáµ‚-Î² (A : U) (B : A â†’ U) (C : (W (x : A), B x) â†’ U)
    (g : Î  (x : A) (f : B x â†’ (W (x : A), B x)),
    (Î  (b : B x), C (f b)) â†’ C (sup A B x f))
    (a : A) (f : B a â†’ (W (x : A), B x))
 := g a f (Î» (b : B a), indáµ‚ A B C g (f b))

def indáµ‚-Î²â€² (A : U) (B : A â†’ U) (C : (W (x : A), B x) â†’ U)
    (g : Î  (x : A) (f : B x â†’ (W (x : A), B x)), (Î  (b : B x), C (f b)) â†’ C (sup A B x f))
    (a : A) (f : B a â†’ (W (x : A), B x))
 := indáµ‚ A B C g (sup A B a f)

def â„• := W (x : ğŸ), indâ‚‚ (Î» (_ : ğŸ), U) ğŸ ğŸ x
def â„•-ctor := indâ‚‚ (Î» (_ : ğŸ), U) ğŸ ğŸ
def zero : â„• := sup ğŸ â„•-ctor 0â‚‚ (indâ‚€ â„•)
def succ (n : â„•) : â„• := sup ğŸ â„•-ctor 1â‚‚ (Î» (x : ğŸ), n)
axiom â„•-ind (c: â„• â†’ U) (z: c zero) (s: Î  (n: â„•), c n -> c (succ n)) : Î  (n : â„•), c n

def Fin (n : â„•) := W (x : ğŸ), indâ‚‚ (Î» (_ : ğŸ), U) ğŸ ğŸ x
def Fin-ctor (n : â„•) := indâ‚‚ (Î» (_ : ğŸ), U) ğŸ ğŸ
def fzero (n : â„•) : Fin n := sup ğŸ (Fin-ctor n) 0â‚‚ (indâ‚€ (Fin n))
def fsucc (n : â„•) (p: Fin n): Fin (succ n) := sup ğŸ (Fin-ctor n) 1â‚‚ (Î» (x : ğŸ), p)

def + (A B: U) : U := Î£ (x : ğŸ), indâ‚‚ (Î» (_ : ğŸ), U) A B x
def inl (A B : U) (a : A) : + A B := (0â‚‚, a)
def inr (A B : U) (b : B) : + A B := (1â‚‚, b)

def maybe (A : U) : U := + ğŸ A
def nothing (A : U) : maybe A := (0â‚‚, â˜…)
def just (A : U) (a : A) : maybe A := (1â‚‚, a)
