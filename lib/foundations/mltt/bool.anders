module bool where

import lib/foundations/mltt/either
import lib/foundations/mltt/proto

def recâ‚‚ (A : U) (a b : A) : ğŸ â†’ A := indâ‚‚ (Î» (_ : ğŸ), A) a b

def ğŸ-Î²â‚ (C : ğŸ â†’ U) (f : Î  (x : ğŸ), C 0â‚‚) (g : Î  (y : ğŸ), C 1â‚‚) 
  : PathP (<_>C 0â‚‚) (f 0â‚‚) (indâ‚‚ (Î» (x : ğŸ), C x) (f 0â‚‚) (g 1â‚‚) 0â‚‚)
 := <_> f 0â‚‚

def ğŸ-Î²â‚‚ (C : ğŸ â†’ U) (f : Î  (x : ğŸ), C 0â‚‚) (g : Î  (y : ğŸ), C 1â‚‚) 
  : PathP (<_>C 1â‚‚) (g 1â‚‚) (indâ‚‚ (Î» (x : ğŸ), C x) (f 0â‚‚) (g 1â‚‚) 1â‚‚)
 := <_> g 1â‚‚

def ğŸ-Î· (c : ğŸ) : + (PathP (<_> ğŸ) c 0â‚‚) (PathP (<_> ğŸ) c 1â‚‚)
 := indâ‚‚ (Î» (c : ğŸ), + (PathP (<_> ğŸ) c 0â‚‚) (PathP (<_> ğŸ) c 1â‚‚))
         (0â‚‚, <_> 0â‚‚) (1â‚‚, <_> 1â‚‚) c

-- data ğŸ : U := 0â‚‚ | 1â‚‚

def not : ğŸ â†’ ğŸ := recâ‚‚ ğŸ 1â‚‚ 0â‚‚
def and : ğŸ â†’ ğŸ â†’ ğŸ := recâ‚‚ (ğŸ â†’ ğŸ) (const ğŸ ğŸ 0â‚‚) (id ğŸ)
def or  : ğŸ â†’ ğŸ â†’ ğŸ := recâ‚‚ (ğŸ â†’ ğŸ) (id ğŸ) (const ğŸ ğŸ 1â‚‚)
def xor : ğŸ â†’ ğŸ â†’ ğŸ := recâ‚‚ (ğŸ â†’ ğŸ) (id ğŸ) not

-- Bitlib

def HA (a b : ğŸ) : ğŸ Ã— ğŸ := (xor a b, and a b)
def orÂ² (a : ğŸ) (w : ğŸ Ã— ğŸ) : ğŸ Ã— ğŸ := (w.1, or a w.2)
def FA (a b cáµ¢â‚™ : ğŸ) : ğŸ Ã— ğŸ := orÂ² (HA a b).2 (HA (HA a b).1 cáµ¢â‚™)
def add-2bit (a b : ğŸ Ã— ğŸ) : ğŸ Ã— ğŸ := ((FA a.1 b.1 (HA a.2 b.2).2).1, (HA a.2 b.2).1)

-- Church

def boolâ€² := Î  (Î± : U), Î± â†’ Î± â†’ Î±
def trueâ€²  : boolâ€² := Î» (Î± : U) (t f : Î±), t
def falseâ€² : boolâ€² := Î» (Î± : U) (t f : Î±), f
def ite (Î± : U) (a b : Î±) (f : boolâ€²) : Î± := f Î± a b
