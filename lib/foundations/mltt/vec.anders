module vec where
import lib/foundations/mltt/nat

def Vec (A : U) : â„• â†’ U := â„•-iter U ğŸ (Î» (X : U), A Ã— X)
def vzero (A : U) : Vec A zero := â˜…
def vsucc (A : U) (n : â„•) (head : A) (tail : Vec A n) : Vec A (succ n) := (head, tail)
def Vec-ind (A : U) (T : Î  (n : â„•), Vec A n â†’ U) (z : T zero (vzero A))
    (s : Î  (n : â„•) (x : A) (v : Vec A n), T n v â†’ T (succ n) (vsucc A n x v)) (m : â„•) : Î  (x : Vec A m), T m x
 := â„•-ind (Î» (k : â„•), Î  (x : Vec A k), T k x)
          (indâ‚ (T zero) z)
          (Î» (k : â„•) (f : Î  (x : Vec A k), T k x) (y : Vec A (succ k)), s k y.1 y.2 (f y.2)) m

def Vec-rec (A B : U) (z : B) (s : Î  (n : â„•), A â†’ Vec A n â†’ B â†’ B) (m : â„•) : Vec A m â†’ B
 := Vec-ind A (Î» (n : â„•) (_ : Vec A n), B) z s m

def Vec-map (A B : U) (f : A â†’ B) (n : â„•) : Vec A n â†’ Vec B n
 := Vec-ind A (Î» (k : â„•) (_ : Vec A k), Vec B k) â˜… (Î» (k : â„•) (x : A) (_ : Vec A k), vsucc B k (f x)) n
