{- Finite Set Type: https://anders.groupoid.space/foundations/mltt/fin/
   - Fin.

   HoTT 1.9 Exercise

   Copyright (c) Groupoid Infinity, 2014-2023. -}

module fin where
import lib/foundations/mltt/either
import lib/foundations/mltt/nat

def Fin : â„• -> U := â„•-iter U ğŸ (+ ğŸ)
def fzero (n : â„•) : Fin (succ n) := (0â‚‚, â˜…)
def fsucc (n : â„•) (m : Fin n) : Fin (succ n) := (1â‚‚, m)
def Fin-ind (T : Î  (n : â„•), Fin n â†’ U)
    (z : Î  (n : â„•), T (succ n) (fzero n))
    (s : Î  (n : â„•) (x : Fin n), T n x â†’ T (succ n) (fsucc n x))
    (m : â„•) (x : Fin m) : T m x
 := â„•-ind (Î» (k : â„•), Î  (x : Fin k), T k x)
          (Î» (x : ğŸ), indâ‚€ (T zero x) x)
          (Î» (k : â„•) (f : Î  (x : Fin k), T k x),
              +-ind ğŸ (Fin k) (T (succ k))
                      (indâ‚ (Î» (w : ğŸ), T (succ k) (0â‚‚, w)) (z k))
                      (Î» (w : Fin k), s k w (f w))) m x

