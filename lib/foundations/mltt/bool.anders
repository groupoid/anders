module bool where
import lib/foundations/univalent/path
import lib/foundations/mltt/either
import lib/foundations/mltt/proto

--- data ğŸ : U := 0â‚‚ | 1â‚‚
def recâ‚‚ (A : U) (a b : A) : ğŸ â†’ A := indâ‚‚ (Î» (_ : ğŸ), A) a b
def not : ğŸ â†’ ğŸ := recâ‚‚ ğŸ 1â‚‚ 0â‚‚
def and : ğŸ â†’ ğŸ â†’ ğŸ := recâ‚‚ (ğŸ â†’ ğŸ) (const ğŸ ğŸ 0â‚‚) (id ğŸ)
def or  : ğŸ â†’ ğŸ â†’ ğŸ := recâ‚‚ (ğŸ â†’ ğŸ) (id ğŸ) (const ğŸ ğŸ 1â‚‚)
def xor : ğŸ â†’ ğŸ â†’ ğŸ := recâ‚‚ (ğŸ â†’ ğŸ) (id ğŸ) not

--- Bitlib
def HA (a b : ğŸ) : ğŸ Ã— ğŸ := (xor a b, and a b)
def orÂ² (a : ğŸ) (w : ğŸ Ã— ğŸ) : ğŸ Ã— ğŸ := (w.1, or a w.2)
def FA (a b cáµ¢â‚™ : ğŸ) : ğŸ Ã— ğŸ := orÂ² (HA a b).2 (HA (HA a b).1 cáµ¢â‚™)
def add-2bit (a b : ğŸ Ã— ğŸ) : ğŸ Ã— ğŸ := ((FA a.1 b.1 (HA a.2 b.2).2).1, (HA a.2 b.2).1)

--- Church
def boolâ€² := Î  (Î± : U), Î± â†’ Î± â†’ Î±
def trueâ€²  : boolâ€² := Î» (Î± : U) (t f : Î±), t
def falseâ€² : boolâ€² := Î» (Î± : U) (t f : Î±), f
def ite (Î± : U) (a b : Î±) (f : boolâ€²) : Î± := f Î± a b

def th722 (A: U) (R: A -> A -> U) (r: Î (x: A), R x x) (h: Î (x y: A), isProp (R x y)) (f: Î  (x y: A), R x y -> Path A x y) : isSet A
 := Î» (a b: A), Î» (p q: Path A a b),
    <i j> hcomp A (âˆ‚ i âˆ¨ âˆ‚ j) (Î» (l : I), [(i = 0) -> p @ l /\ j,
                                           (i = 1) -> q @ l /\ j,
                                           (j = 0) -> f (p @ j) (q @ j) (h (p @ j) (q @ j) (r a) (r (p @ i /\ j)) @ j) @ -l \/ -j,
                                           (j = 1) -> f a b (transp (<i> R a (q @ i)) 0 (r a)) @ l]) a

def cor723 (A: U) (h: Î  (x y: A), ((Path A x y -> ğŸ) -> ğŸ) -> Path A x y) : isSet A
 := th722 A (Î» (x y: A), (Path A x y -> ğŸ) -> ğŸ) (Î» (x: A) (g: Path A x x -> ğŸ), g (<i0> x))
            (Î»(x y: A) (a b: (Path A x y -> ğŸ) -> ğŸ), <j> Î» (p: Path A x y -> ğŸ), indâ‚€ (Path ğŸ (a p) (b p)) (a p) @ j) h

def ffineqtt (h: Path ğŸ 0â‚‚ 1â‚‚) : ğŸ
 := transp (<i> indâ‚‚ (Î»(_: ğŸ), U) ğŸ ğŸ (h @ -i)) 0 â˜…

def boolset : isSet ğŸ
 := cor723 ğŸ (indâ‚‚ (Î» (x: ğŸ), Î  (y: ğŸ), ((Path ğŸ x y -> ğŸ) ->ğŸ) -> Path ğŸ x y)
               (indâ‚‚ (Î» (y: ğŸ), ((Path ğŸ 0â‚‚ y -> ğŸ) -> ğŸ) -> Path ğŸ 0â‚‚ y)
                 (Î» (h00: ((Path ğŸ 0â‚‚ 0â‚‚ -> ğŸ) -> ğŸ)), <i1> 0â‚‚)
                   (Î» (h01: ((Path ğŸ 0â‚‚ 1â‚‚ -> ğŸ) -> ğŸ)), indâ‚€ (Path ğŸ 0â‚‚ 1â‚‚) (h01 ffineqtt)))
               (indâ‚‚ (Î» (y: ğŸ), ((Path ğŸ 1â‚‚ y -> ğŸ) ->ğŸ) -> Path ğŸ 1â‚‚ y)
                 (Î» (h10: ((Path ğŸ 1â‚‚ 0â‚‚ -> ğŸ) -> ğŸ)), indâ‚€ (Path ğŸ 1â‚‚ 0â‚‚) (h10 (Î» (g: Path ğŸ 1â‚‚ 0â‚‚), ffineqtt (<l> g @ -l))))
                   (Î» (h11: ((Path ğŸ 1â‚‚ 1â‚‚ -> ğŸ) -> ğŸ)), <j> 1â‚‚)))
